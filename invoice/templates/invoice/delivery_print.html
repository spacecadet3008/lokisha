<!-- templates/invoice/delivery_print.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Delivery #{{ delivery.delivery_number }}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @media print {
            body {
                margin: 0;
                padding: 15px;
                font-size: 12px;
            }
            .no-print {
                display: none !important;
            }
            .delivery-print-container {
                border: none !important;
                box-shadow: none !important;
            }
            .table {
                font-size: 11px;
            }
            .badge {
                font-size: 10px;
                padding: 4px 8px;
            }
        }
        body {
            background: white !important;
            font-family: Arial, sans-serif;
        }
        .delivery-print-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .company-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #28a745;
        }
        .company-logo {
            width: 100px;
            height: 100px;
            margin-right: 20px;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 5px;
            background: white;
        }
        .company-details {
            flex: 1;
        }
    </style>
</head>
<body>
<div class="delivery-print-container">
    <!-- Header with Logo and Company Details -->
    <div class="company-header">
        <img src="{% static '../images/logo/lokisha_1.png' %}" alt="Lokisha Enterprise" class="company-logo">
        <div class="company-details">
            <h2 class="text-success mb-1">LOKISHA ENTERPRISE</h2>
            <p class="mb-1">Business Solutions & Consultancy</p>
            <p class="mb-1">P.O. Box 295, Arusha, Tanzania</p>
            <p class="mb-1">Phone: +255 123 456 789</p>
            <p class="mb-0">Email: info@lokisha.co.tz</p>
        </div>
        
        <!-- Delivery Info on the right -->
        <div class="text-end">
            <h5 class="mb-2">
                <span class="badge bg-primary">DELIVERY NOTE</span>
            </h5>
            <p class="mb-1"><strong>Delivery #:</strong> {{ delivery.delivery_number }}</p>
            <p class="mb-1"><strong>Date:</strong> {{ delivery.date|date:"M d, Y" }}</p>
            <p class="mb-0">
                <strong>Status:</strong> 
                <span class="badge 
                    {% if delivery.status == 'draft' %}bg-secondary
                    {% elif delivery.status == 'preparing' %}bg-warning
                    {% elif delivery.status == 'dispatched' %}bg-info
                    {% elif delivery.status == 'delivered' %}bg-success
                    {% else %}bg-danger{% endif %}">
                    {{ delivery.status|title }}
                </span>
            </p>
        </div>
    </div>

    <!-- Delivery Details -->
    <div class="row mb-4">
        <!-- Customer Information -->
        <div class="col-md-6">
            <div class="card border-0">
                <div class="card-body p-3 bg-light">
                    <h6 class="card-title border-bottom pb-2">Customer Information</h6>
                    <p class="mb-1"><strong>{{ delivery.customer_name.first_name }} {{ delivery.customer_name.last_name }}</strong></p>
                    <p class="mb-1">Phone: {{ delivery.contact_number }}</p>
                    {% if delivery.customer_name.email %}
                    <p class="mb-1">Email: {{ delivery.customer_name.email }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Delivery Address -->
        <div class="col-md-6">
            <div class="card border-0">
                <div class="card-body p-3 bg-light">
                    <h6 class="card-title border-bottom pb-2">Delivery Address</h6>
                    <p class="mb-0">{{ delivery.shipping_address|linebreaks }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Items Table -->
    <div class="card border-0 mb-4">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead class="table-success">
                        <tr>
                            <th>Item</th>
                            <th class="text-center">Quantity</th>
                            <th class="text-end">Unit Price (Tsh)</th>
                            <th class="text-end">Total (Tsh)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in delivery.items.all %}
                        <tr>
                            <td>{{ item.item.name }}</td>
                            <td class="text-center">{{ item.quantity|floatformat:2 }}</td>
                            <td class="text-end">{{ item.price_per_item|floatformat:2 }}</td>
                            <td class="text-end">{{ item.total_price|floatformat:2 }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    <tfoot class="table-light">
                        <tr>
                            <td colspan="3" class="text-end fw-bold">Total Value:</td>
                            <td class="text-end fw-bold">Tsh {{ delivery_total|floatformat:2 }}</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

    <!-- Delivery Notes -->
    {% if delivery.notes %}
    <div class="card border-0 mb-4">
        <div class="card-body p-3 bg-light">
            <h6 class="card-title border-bottom pb-2">Delivery Notes</h6>
            <p class="mb-0">{{ delivery.notes|linebreaks }}</p>
        </div>
    </div>
    {% endif %}

    <!-- Signatures -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="border-top pt-3 text-center">
                <p class="mb-1">_________________________</p>
                <p class="text-muted mb-0">Customer Signature</p>
            </div>
        </div>
        <div class="col-md-6">
            <div class="border-top pt-3 text-center">
                <p class="mb-1">_________________________</p>
                <p class="text-muted mb-0">Driver Signature</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="row mt-4">
        <div class="col-12 text-center">
            <p class="text-muted mb-0">
                <i class="fas fa-phone me-1"></i> +255 123 456 789 | 
                <i class="fas fa-envelope ms-2 me-1"></i> info@lokisha.co.tz
            </p>
        </div>
    </div>
</div>

<script>
    // Auto-print when page loads
    window.onload = function() {
        window.print();
        
        // Close window after printing (optional)
        setTimeout(function() {
            window.close();
        }, 500);
    }
    
    // Allow manual printing with Ctrl+P
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'p') {
            e.preventDefault();
            window.print();
        }
    });
</script>
</body>
</html>